<!DOCTYPE html>
<html>
	<head>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117108133-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());

			gtag('config', 'UA-117108133-1');
		</script>

		<meta charset="utf-8">
		<title>Hardpoint</title>

		<script src="//unpkg.com/lodash"></script>

		<link rel="stylesheet" type="text/css" href="//unpkg.com/iview/dist/styles/iview.css">

		<script src="//unpkg.com/vue"></script>
		<script src="//unpkg.com/vue-router/dist/vue-router.js"></script>
		<script src="//unpkg.com/iview/dist/iview.min.js"></script>
		<script src="//unpkg.com/iview/dist/locale/en-US.js"></script>
		<script>
			iview.lang('en-US');
		</script>

		<script type="text/javascript" src="data/3.1.0-739258/shipSpecifications.js"></script>
		<script type="text/javascript" src="data/3.1.0-739258/shipLoadouts.js"></script>
		<script type="text/javascript" src="data/3.1.0-739258/spaceshipComponents.js"></script>
		<script type="text/javascript" src="data/3.1.0-739258/dataforgeComponents.js"></script>
		<script type="text/javascript" src="data/3.1.0-739258/localizationStrings.js"></script>

		<link rel="stylesheet" href="style.css">
	</head>
	<body>
		<div id="app">
			<div class="layout">
				<div class="header">
				<row>
					<i-col span="24">
						<h1>Hardpoint</h1>
					</i-col>
				</row>
				<row>
					<i-col span="12">
						<p>An increasingly weaponized spreadsheet for Star Citizen ships and equipment</p>
					</i-col>
					<i-col span="12" class="right">
						<p>Star Citizen Version 3.1.0-739258</p>
					</i-col>
				</row>
				</div>
				<div class="content">
					<router-view></router-view>
				</div>
				<div class="footer">
					<p>Thanks to <a href="http://starcitizendb.com/">StarCitizenDB</a> for the data!</p>
				</div>
			</div>
		</div>

		<template id="ship-list">
			<row>
				<i-col span="24">
					<i-table
						:columns="attributeColumns"
						:data="shipAttributes"
						:height="tableHeight"
						highlight-row
						stripe>
					</i-table>
				</i-col>
			</row>
		</template>

		<template id="item-port-group">
			<div class="item-port-group">
				<div class="group-row">
					<div class="group-indicator" :class="{'group-indicator-border': linkable}">
						<div class="group-indicator-label" v-if="linkable">
							<p v-if="linked">
								{{ group.length }}x
							</p>
							<i-button size="small" @click="onClick">
								{{ buttonText }}
							</i-button>
						</div>
					</div>
					<div class="group-content">
						<div class="group-content-entry" v-for="port in group" v-if="!linked">
							<slot :ports="[port]"></slot>
						</div>
						<div class="group-content-entry" v-if="linked">
							<slot :ports="group"></slot>
						</div>
					</div>
				</div>
			</div>
		</template>

		<template id="ship-details">
			<row :gutter="16">
				<i-col span="24" class="title">
					<h1>{{selectedCustomization.displayName}}</h1>
					<p>Return to the <router-link :to="{name: 'list'}">comparison view</router-link> to select a different ship</p>
				</i-col>
				<i-col span="17">
					<collapse v-model="expandedSections">
						<panel v-for="sectionName in sectionNames" :key="sectionName" :name="sectionName">
							{{sectionName}}
							<div slot="content">
								<item-port-group
									v-for="group in getItemPortGroups(getSectionItemPorts(sectionName))"
									:key="JSON.stringify(selectedCustomization.shipId) + JSON.stringify(group)"
									:customization="selectedCustomization"
									:group="group" >
									<template slot-scope="parent">
										<div class="component-and-children-selector">
											<component-selector
												:customization="selectedCustomization"
												:item-ports="parent.ports">
											</component-selector>
											<item-port-group
												v-for="childGroup in getItemPortGroups(getAttachedComponentItemPorts(parent.ports[0].name), parent.ports)"
												:key="JSON.stringify(selectedCustomization.shipId) + JSON.stringify(childGroup)"
												:customization="selectedCustomization"
												:group="childGroup"
												:parent-ports="parent.ports">
												<template slot-scope="child">
													<component-selector
														:customization="selectedCustomization"
														:item-ports="child.ports"
														:parent-item-ports="parent.ports">
													</component-selector>
												</template>
											</item-port-group>
										</div>
									</template>
								</item-port-group>
							</div>
						</panel>
					</collapse>
				</i-col>
				<i-col span="7">
					<i-table :columns="damageColumns" :data="selectedCustomization.getAttributes('Damage')"></i-table>
					<i-table :columns="maneuverabilityColumns" :data="selectedCustomization.getAttributes('Maneuverability')"></i-table>
					<i-table :columns="survivabilityColumns" :data="selectedCustomization.getAttributes('Survivability')"></i-table>
				</i-col>
			</row>
		</template>

		<template id="component-display">
			<i-button :disabled="disabled">
				<row v-if="componentName==undefined" style="text-align: center;">
					Empty
				</row>
				<row v-if="componentName">
					<i-col span="12">
						<strong>{{component.displayName}}</strong>
					</i-col>
					<i-col span="12" class="right">
						{{component.type}}
					</i-col>
				</row>
				<row v-if="componentName">
					<i-col span="12">
						<span v-html="component.summary.render()"></span>
					</i-col>
						<i-col span="12" class="right">
						Size {{component.size}}
					</i-col>
				</row>
			</i-button>
		</template>

		<template id="component-selector">
			<div class="component-selector">
				{{label}}
				<br />
				<dropdown
					ref="dropdown"
					:trigger="itemPorts[0].editable ? 'click' : 'custom'"
					class="component-selector"
					@on-visible-change="onVisibleChange"
					@on-click="onClick">

					<component-display :component-name="selectedComponentName" :disabled="!itemPorts[0].editable">
					</component-display>
					<span :class="{'flip-icon': visible}"><i class="ivu-icon ivu-icon-arrow-down-b ivu-select-arrow"></i></span>

					<dropdown-menu slot="list">
						<dropdown-item v-for="componentName in availableComponents" :name="componentName" :key="componentName">
							<component-display :component-name="componentName">
							</component-display>
						</dropdown-item>
					</dropdown-menu>
				</dropdown>
			</div>
		</template>

		<script src="code.js"></script>
	</body>
</html>